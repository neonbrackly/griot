# REQ-001: Fix NoneType bug in validate_contract_structure

| From | To | Status | Created | Resolved |
|------|-----|--------|---------|----------|
| registry | core | **RESOLVED** | 2026-01-20 | 2026-01-20 |

## Request

There was a bug in `griot-core/src/griot_core/contract.py` at line 1017 in the `validate_contract_structure` function:

```python
if field_info.custom_properties.get("privacy").get("is_pii") and field_info.custom_properties.get("privacy").get("pii_type") is None:
```

This line raised `AttributeError: 'NoneType' object has no attribute 'get'` when `custom_properties.get("privacy")` returned `None` (which happens when a field doesn't have privacy settings defined).

## Fix Applied

The Registry Agent applied the fix directly since it was blocking API testing:

```python
privacy = field_info.custom_properties.get("privacy") or {}
if privacy.get("is_pii") and privacy.get("pii_type") is None:
```

**File Modified:** `griot-core/src/griot_core/contract.py:1017`

## Priority
high (was blocking)

## Resolution Notes
- Fix has been applied to the source code
- Server restart required to load the updated code
- See `agents/status/CHANGES-PENDING-RESTART.md` for details

## Impact (Resolved)
The griot-registry API now works correctly for contracts with or without `customProperties.privacy` defined (after server restart).
